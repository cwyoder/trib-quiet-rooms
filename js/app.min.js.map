{"version":3,"sources":["node_modules/browser-pack/_prelude.js","js/src/app.js","js/src/load-element.js","node_modules/lodash.throttle/index.js","node_modules/pym.js/dist/pym.v1.js","node_modules/scrollmonitor/scrollMonitor.js"],"names":["isMobile","window","innerWidth","animateLede","q","log","school","date","p","document","querySelector","t","r","s","setshowhide","i","pp","scrolledOnce","textContent","length","substr","style","marginLeft","getRandomInt","marginTop","classList","add","setTimeout","remove","dummy","createElement","onload","bind","d","src","getComputedStyle","getElementById","backgroundImage","slice","replace","addEventListener","e","once","_loadElement","require","_driftZoom","scrollMonitor","pym","throttle","thumbs","querySelectorAll","details","call","forEach","loadElement","lazyItems","map","el","lazyWatcher","create","top","bottom","throttledLazyLoad","enterViewport","destroy","len","thumb","detail","Drift","paneContainer","inlinePane","inlineOffsetY","containInline","hoverBoundingBox","injectBaseStyles","zoomFactor","lazyVideos","lazyVideoObserver","IntersectionObserver","entries","observer","video","isIntersecting","source","target","children","videoSource","tagName","dataset","load","console","play","unobserve","lazyVideo","observe","recalculateLocations","documentElement","min","max","step","Math","ceil","floor","random","contains","chartContainer","pymId","id","pymUrl","iframeUrl","Parent","setAttribute","elBox","getBoundingClientRect","newDimension","width","height","round","fullResSrc","getAttribute","debounce","func","wait","options","invokeFunc","time","args","lastArgs","thisArg","lastThis","undefined","lastInvokeTime","result","apply","leadingEdge","timerId","timerExpired","leading","remainingWait","timeSinceLastCall","lastCallTime","timeSinceLastInvoke","maxing","nativeMin","maxWait","shouldInvoke","now","trailingEdge","trailing","cancel","clearTimeout","flush","debounced","isInvoking","arguments","this","TypeError","FUNC_ERROR_TEXT","toNumber","isObject","nativeMax","value","type","isObjectLike","isSymbol","objectToString","symbolTag","NAN","other","valueOf","reTrim","isBinary","reIsBinary","test","reIsOctal","freeParseInt","reIsBadHex","parseInt","freeGlobal","global","Object","freeSelf","self","root","Function","objectProto","prototype","toString","Date","module","exports","factory","define","amd","lib","_raiseCustomEvent","eventName","event","createEvent","initEvent","dispatchEvent","_getParameterByName","name","regex","RegExp","results","exec","location","search","decodeURIComponent","_isSafeMessage","settings","xdomain","origin","match","data","_isSafeUrl","url","SAFE_URL_PATTERN","_makeMessage","messageType","message","join","_makeMessageRegex","bits","_getNow","getTime","_throttle","context","timeout","previous","later","remaining","_cleanAutoInitInstances","autoInitInstances","idx","instance","getElementsByTagName","contentWindow","splice","autoInit","doNotRaiseEvents","elements","element","title","sandbox","allowfullscreen","parenturlparam","parenturlvalue","optionalparams","trackscroll","scrollwait","config","attribute","n","Number","isNaN","err","parent","push","iframe","href","messageRegex","messageHandlers","_constructIframe","offsetWidth","hash","hashIndex","indexOf","substring","encodeURIComponent","firstChild","removeChild","appendChild","_onResize","_throttleOnScroll","sendWidth","sendViewportAndIFramePosition","_onScroll","_fire","removeEventListener","_processMessage","_onHeightMessage","_onNavigateToMessage","_onScrollToChildPosMessage","iframePos","pageYOffset","totalOffset","scrollTo","onMessage","callback","sendMessage","postMessage","iframeRect","vWidth","clientWidth","vHeight","innerHeight","clientHeight","payload","left","right","key","Child","parentWidth","parentTitle","parentUrl","renderCallback","polling","_onWidthMessage","sendHeight","offsetHeight","getParentPositionInfo","scrollParentTo","navigateParentTo","scrollParentToChildEl","topPos","scrollParentToChildPos","pos","clearInterval","setInterval","onMarkedEmbeddedStatus","newClassForHtml","htmlElement","originalHtmlClasses","className","o","loaded","m","c","isInBrowser","body","setStateFromDOM","listenToDOM","VISIBILITYCHANGE","ENTERVIEWPORT","FULLYENTERVIEWPORT","EXITVIEWPORT","PARTIALLYEXITVIEWPORT","LOCATIONCHANGE","STATECHANGE","eventTypes","isOnServer","defaultOffsets","scrollHeight","scrollTop","h","a","l","u","w","defineProperty","get","capture","passive","f","viewportTop","viewportBottom","viewportHeight","documentHeight","watchers","recalculateLocation","update","triggerCallbacks","item","DOMListener","containerWatcher","attachEvent","detachEvent","setState","contentHeight","latestEvent","updateAndTriggerWatchers","createCustomContainer","createContainer","beget","E","y","isOne","watchItem","container","offsets","callbacks","locked","v","b","I","isInViewport","isFullyInViewport","isAboveViewport","isBelowViewport","nodeName","display","on","Error","off","one","recalculateSize","lock","unlock"],"mappings":"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","file":"bundle.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()","import {loadElement} from './load-element.js';\nimport Drift from 'drift-zoom';\n//Copyright (c) 2015-2018, Zebrafish Labs All rights reserved.\n//https://github.com/imgix/drift\n\n\n  \nconst   scrollMonitor = require('scrollmonitor'),\n        pym = require('pym.js'),\n        throttle = require('lodash.throttle');\n  \nfunction isMobile(){\n    return window.innerWidth < 850 ? true : false;\n}\n\nvar thumbs = document.querySelectorAll('.doc-thmb');\nvar details = document.querySelectorAll('.doc-detail');\n  \n// #########################################\n// ######### DOMCONTENT LOADED #############\n// #########################################\n  \nwindow.addEventListener('DOMContentLoaded', function(e){\n\n    // First, start by loading the non-lazy charts/graphics by looking \n    // for the charts WITHOUT the lazy class.\n    const nonLazyItems = [].slice.call(document.querySelectorAll('.chart:not(.chart--lazy)'));\n    nonLazyItems.forEach(i => loadElement(i));\n\n    // Also, let's lazyload the images and charts\n    const lazyItems = [].slice.call(document.querySelectorAll('.image--lazy, .chart--lazy, .audio--lazy'));\n    const lazyWatchers = lazyItems.map(el => {\n  \n        const lazyWatcher = scrollMonitor.create(el, {\n            top: 500,\n            bottom: 500\n        });\n  \n        // This will let us load pictures/graphics/etc. without overwhelming \n        // the client. Loads are limited to one every 100ms.\n        const throttledLazyLoad = throttle(function(){ loadElement(el) }, 100);\n  \n        lazyWatcher.enterViewport(function(){\n            // First bring on the lazy content, but only once every 1/10 second\n            throttledLazyLoad();\n  \n            // Now that the image is loaded, we can kill the watcher.\n            lazyWatcher.destroy();\n        });\n        return lazyWatcher;\n    });\n\n    // Implementing document drift-zoom function\n    for (var i = 0, len = thumbs.length; i < len; i++) {\n        var thumb = thumbs[i];\n        var detail = details[i];\n\n        new Drift(thumb, {\n            paneContainer: detail,\n            inlinePane: true,\n            inlineOffsetY: -75,\n            containInline: false,\n            hoverBoundingBox: true,\n            injectBaseStyles: true,\n            zoomFactor: 1.75\n        });\n    }\n\n    //animating the lede\n    animateLede();\n\n    //Lazyloading videos\n\n    var lazyVideos = [].slice.call(document.querySelectorAll(\"video.lazyvideo\"));\n\n    if (\"IntersectionObserver\" in window) {\n        var lazyVideoObserver = new IntersectionObserver(function(entries, observer) {\n            entries.forEach(function(video) {\n                if (video.isIntersecting) {\n                    for (var source in video.target.children) {\n                        var videoSource = video.target.children[source];\n                        if (typeof videoSource.tagName === \"string\" && videoSource.tagName === \"SOURCE\") {\n                            videoSource.src = videoSource.dataset.src;\n                        }\n                    }\n\n                    video.target.load();\n                    console.log(\"video loaded\");\n                    video.target.play();\n                    video.target.classList.remove(\"lazyvideo\");\n                    lazyVideoObserver.unobserve(video.target);\n                }\n            });\n        });\n\n        lazyVideos.forEach(function(lazyVideo) {\n            lazyVideoObserver.observe(lazyVideo);\n        });\n    }\n\n});\n\n\n// #########################################\n// ########### DOCUMENT LOADED #############\n// #########################################\n  \nwindow.addEventListener('load', function() {  \n    // Now that the css is parsed and rendered, let's recalc all our waypoints\n    scrollMonitor.recalculateLocations();\n});\n\n\n// #########################################\n// ########### ANIMATING LEDE  #############\n// #########################################\n\nconst pp = {\n    // via @ashaw\n    isMobile: ('ontouchstart' in document.documentElement && window.innerWidth <= 600),\n    scrolledOnce: false\n};\n\n\nlet getRandomInt = function(min, max, step) {\n    min = Math.ceil(min);\n    max = Math.floor(max);\n    return Math.floor(Math.random()*((max-min)/step))*step + min;\n};\nfunction animateLede() {\n    let q = [\n      {\n        \"log\": \"Why am I even in here? Let me go. Let me go.\\”\",\n        \"school\": \"Braun Educational Center\",\n        \"date\": \"Nov. 2, 2017\"\n      },\n      {\n        \"log\": \"I want my mom and dad. I love them.\\”\",\n        \"school\": \"Mattoon Community Unit School District\",\n        \"date\": \"Dec. 11, 2017\"\n      },\n      {\n        \"log\": \"You lock kids in here.\\”\",\n        \"school\": \"Bridges Learning Center\",\n        \"date\": \"Nov. 29, 2017\"\n      },\n      {\n        \"log\": \"I'm scared.\\”\",\n        \"school\": \"Chester-East Lincoln Elementary School\",\n        \"date\": \"Sept. 22, 2017\"\n      },\n      {\n        \"log\": \"Help, help, help me!\\”\",\n        \"school\": \"Wabash and Ohio Valley Special Education District\",\n        \"date\": \"Sept. 19, 2018\"\n      },\n      {\n        \"log\": \"\\“Why? Why are you doing this to me?\\”\",\n        \"school\": \"Bridges Learning Center\",\n        \"date\": \"Nov. 21, 2017\"\n      }\n    ];\n    let p = document.querySelector('#lede-quote'); // parent container\n    let t = document.querySelector('header.full-bleed .titles'); // hed/dek\n    let d = 2000; // delay in ms\n    let r = 'show'; // reveal class\n    var s = 0; // running count\n\n    let setshowhide = function(i, s) {\n        if (!pp.scrolledOnce) { // do nothing if user has already scrolled\n            p.querySelector('.date').textContent = q[i].date;\n            p.querySelector('.school').textContent = q[i].school;\n            if (i < q.length-1) {\n                p.querySelector('.log').textContent = q[i].log.substr(0);\n                p.style.marginLeft = (pp.isMobile ? getRandomInt(2,10,4) : getRandomInt(6,26,4)) + 'rem';\n                p.style.marginTop = (pp.isMobile ? getRandomInt(0,16,4) : getRandomInt(0,16,4)) + 'rem';\n            } else {\n                p.querySelector('.log').textContent = q[i].log;\n                p.style.marginLeft = 'auto';\n                p.style.marginTop = (pp.isMobile ? '8rem' : '7vw');\n                p.classList.add('final');\n            }\n            p.classList.add(r);\n            setTimeout(function(){\n                if (i < q.length-1) {\n                    // hide the quote\n                    p.classList.remove(r);\n                } else {\n                    // show hed/dek\n                    t.classList.add(r);\n                    // then hide last quote\n                    setTimeout(function(){p.classList.remove(r);}, d/3);\n                }\n            }, d);\n        }\n    };\n\n\n    // load lede img asset in a dummy img elem, which caches in browser memory;\n    var dummy = document.createElement('img');\n    // bind animations to start on load callback\n    dummy.onload = function() {\n        dummy.remove(); // prevent memory leaks\n        // start img animation\n        document.querySelector('#lede-art').classList.add('panning');\n        // start quotes animation\n        var i;\n        for (i = 0; i < q.length; i++) {\n            setTimeout(setshowhide.bind(null, i, s), s);\n            s += d*2;\n        }\n    };\n    // use whichever responsive img was defined in css\n    dummy.src = window.getComputedStyle(document.getElementById('lede-art'))\n                      .backgroundImage\n                      .slice(4, -1).replace(/['\"]/g, \"\");\n\n\n    // on scroll (once), show lede if it isn't already\n    setTimeout(() => {\n        window.addEventListener('scroll', (e) => {\n            pp.scrolledOnce = true;\n            t.classList.add(r);\n        }, {once: true});\n    }, 100);\n}\n","const pym = require('pym.js');\n  \nexport function loadElement(el){\n    // Function we use for loading graphics and lazyloading images.\n    if (el.classList.contains('chart--lazy')){\n        // if we're dealing with a graphic\n        const   chartContainer = el.querySelector('.graphic-embed'),\n                pymId = chartContainer.id,\n                pymUrl = chartContainer.dataset.iframeUrl;\n                new pym.Parent(pymId, pymUrl, {});\n    } else if (el.classList.contains('audio--lazy')){\n        const src = el.dataset.src;\n        el.setAttribute('src', src);\n    } else {\n        // If we're dealing with an image\n        const   elBox = el.getBoundingClientRect(),\n                newDimension = elBox.width > elBox.height ? Math.round(elBox.width) : Math.round(elBox.height),\n                fullResSrc = el.querySelector('img').getAttribute(\"src\").replace(\"/10\", `/${newDimension}`).replace(/’/g, \"\"); // Damn smart quotes are appearing again\n        // console.log('lazy loading ', fullResSrc);\n        el.querySelector('img').setAttribute('src', fullResSrc);\n    }\n}\n","/**\n * lodash (Custom Build) <https://lodash.com/>\n * Build: `lodash modularize exports=\"npm\" -o ./`\n * Copyright jQuery Foundation and other contributors <https://jquery.org/>\n * Released under MIT license <https://lodash.com/license>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n */\n\n/** Used as the `TypeError` message for \"Functions\" methods. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/** Used as references for various `Number` constants. */\nvar NAN = 0 / 0;\n\n/** `Object#toString` result references. */\nvar symbolTag = '[object Symbol]';\n\n/** Used to match leading and trailing whitespace. */\nvar reTrim = /^\\s+|\\s+$/g;\n\n/** Used to detect bad signed hexadecimal string values. */\nvar reIsBadHex = /^[-+]0x[0-9a-f]+$/i;\n\n/** Used to detect binary string values. */\nvar reIsBinary = /^0b[01]+$/i;\n\n/** Used to detect octal string values. */\nvar reIsOctal = /^0o[0-7]+$/i;\n\n/** Built-in method references without a dependency on `root`. */\nvar freeParseInt = parseInt;\n\n/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar objectToString = objectProto.toString;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max,\n    nativeMin = Math.min;\n\n/**\n * Gets the timestamp of the number of milliseconds that have elapsed since\n * the Unix epoch (1 January 1970 00:00:00 UTC).\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Date\n * @returns {number} Returns the timestamp.\n * @example\n *\n * _.defer(function(stamp) {\n *   console.log(_.now() - stamp);\n * }, _.now());\n * // => Logs the number of milliseconds it took for the deferred invocation.\n */\nvar now = function() {\n  return root.Date.now();\n};\n\n/**\n * Creates a debounced function that delays invoking `func` until after `wait`\n * milliseconds have elapsed since the last time the debounced function was\n * invoked. The debounced function comes with a `cancel` method to cancel\n * delayed `func` invocations and a `flush` method to immediately invoke them.\n * Provide `options` to indicate whether `func` should be invoked on the\n * leading and/or trailing edge of the `wait` timeout. The `func` is invoked\n * with the last arguments provided to the debounced function. Subsequent\n * calls to the debounced function return the result of the last `func`\n * invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the debounced function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.debounce` and `_.throttle`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to debounce.\n * @param {number} [wait=0] The number of milliseconds to delay.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=false]\n *  Specify invoking on the leading edge of the timeout.\n * @param {number} [options.maxWait]\n *  The maximum time `func` is allowed to be delayed before it's invoked.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new debounced function.\n * @example\n *\n * // Avoid costly calculations while the window size is in flux.\n * jQuery(window).on('resize', _.debounce(calculateLayout, 150));\n *\n * // Invoke `sendMail` when clicked, debouncing subsequent calls.\n * jQuery(element).on('click', _.debounce(sendMail, 300, {\n *   'leading': true,\n *   'trailing': false\n * }));\n *\n * // Ensure `batchLog` is invoked once after 1 second of debounced calls.\n * var debounced = _.debounce(batchLog, 250, { 'maxWait': 1000 });\n * var source = new EventSource('/stream');\n * jQuery(source).on('message', debounced);\n *\n * // Cancel the trailing debounced invocation.\n * jQuery(window).on('popstate', debounced.cancel);\n */\nfunction debounce(func, wait, options) {\n  var lastArgs,\n      lastThis,\n      maxWait,\n      result,\n      timerId,\n      lastCallTime,\n      lastInvokeTime = 0,\n      leading = false,\n      maxing = false,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  wait = toNumber(wait) || 0;\n  if (isObject(options)) {\n    leading = !!options.leading;\n    maxing = 'maxWait' in options;\n    maxWait = maxing ? nativeMax(toNumber(options.maxWait) || 0, wait) : maxWait;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n\n  function invokeFunc(time) {\n    var args = lastArgs,\n        thisArg = lastThis;\n\n    lastArgs = lastThis = undefined;\n    lastInvokeTime = time;\n    result = func.apply(thisArg, args);\n    return result;\n  }\n\n  function leadingEdge(time) {\n    // Reset any `maxWait` timer.\n    lastInvokeTime = time;\n    // Start the timer for the trailing edge.\n    timerId = setTimeout(timerExpired, wait);\n    // Invoke the leading edge.\n    return leading ? invokeFunc(time) : result;\n  }\n\n  function remainingWait(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime,\n        result = wait - timeSinceLastCall;\n\n    return maxing ? nativeMin(result, maxWait - timeSinceLastInvoke) : result;\n  }\n\n  function shouldInvoke(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime;\n\n    // Either this is the first call, activity has stopped and we're at the\n    // trailing edge, the system time has gone backwards and we're treating\n    // it as the trailing edge, or we've hit the `maxWait` limit.\n    return (lastCallTime === undefined || (timeSinceLastCall >= wait) ||\n      (timeSinceLastCall < 0) || (maxing && timeSinceLastInvoke >= maxWait));\n  }\n\n  function timerExpired() {\n    var time = now();\n    if (shouldInvoke(time)) {\n      return trailingEdge(time);\n    }\n    // Restart the timer.\n    timerId = setTimeout(timerExpired, remainingWait(time));\n  }\n\n  function trailingEdge(time) {\n    timerId = undefined;\n\n    // Only invoke if we have `lastArgs` which means `func` has been\n    // debounced at least once.\n    if (trailing && lastArgs) {\n      return invokeFunc(time);\n    }\n    lastArgs = lastThis = undefined;\n    return result;\n  }\n\n  function cancel() {\n    if (timerId !== undefined) {\n      clearTimeout(timerId);\n    }\n    lastInvokeTime = 0;\n    lastArgs = lastCallTime = lastThis = timerId = undefined;\n  }\n\n  function flush() {\n    return timerId === undefined ? result : trailingEdge(now());\n  }\n\n  function debounced() {\n    var time = now(),\n        isInvoking = shouldInvoke(time);\n\n    lastArgs = arguments;\n    lastThis = this;\n    lastCallTime = time;\n\n    if (isInvoking) {\n      if (timerId === undefined) {\n        return leadingEdge(lastCallTime);\n      }\n      if (maxing) {\n        // Handle invocations in a tight loop.\n        timerId = setTimeout(timerExpired, wait);\n        return invokeFunc(lastCallTime);\n      }\n    }\n    if (timerId === undefined) {\n      timerId = setTimeout(timerExpired, wait);\n    }\n    return result;\n  }\n  debounced.cancel = cancel;\n  debounced.flush = flush;\n  return debounced;\n}\n\n/**\n * Creates a throttled function that only invokes `func` at most once per\n * every `wait` milliseconds. The throttled function comes with a `cancel`\n * method to cancel delayed `func` invocations and a `flush` method to\n * immediately invoke them. Provide `options` to indicate whether `func`\n * should be invoked on the leading and/or trailing edge of the `wait`\n * timeout. The `func` is invoked with the last arguments provided to the\n * throttled function. Subsequent calls to the throttled function return the\n * result of the last `func` invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the throttled function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.throttle` and `_.debounce`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to throttle.\n * @param {number} [wait=0] The number of milliseconds to throttle invocations to.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=true]\n *  Specify invoking on the leading edge of the timeout.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new throttled function.\n * @example\n *\n * // Avoid excessively updating the position while scrolling.\n * jQuery(window).on('scroll', _.throttle(updatePosition, 100));\n *\n * // Invoke `renewToken` when the click event is fired, but not more than once every 5 minutes.\n * var throttled = _.throttle(renewToken, 300000, { 'trailing': false });\n * jQuery(element).on('click', throttled);\n *\n * // Cancel the trailing throttled invocation.\n * jQuery(window).on('popstate', throttled.cancel);\n */\nfunction throttle(func, wait, options) {\n  var leading = true,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  if (isObject(options)) {\n    leading = 'leading' in options ? !!options.leading : leading;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n  return debounce(func, wait, {\n    'leading': leading,\n    'maxWait': wait,\n    'trailing': trailing\n  });\n}\n\n/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return !!value && (type == 'object' || type == 'function');\n}\n\n/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return !!value && typeof value == 'object';\n}\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == 'symbol' ||\n    (isObjectLike(value) && objectToString.call(value) == symbolTag);\n}\n\n/**\n * Converts `value` to a number.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to process.\n * @returns {number} Returns the number.\n * @example\n *\n * _.toNumber(3.2);\n * // => 3.2\n *\n * _.toNumber(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toNumber(Infinity);\n * // => Infinity\n *\n * _.toNumber('3.2');\n * // => 3.2\n */\nfunction toNumber(value) {\n  if (typeof value == 'number') {\n    return value;\n  }\n  if (isSymbol(value)) {\n    return NAN;\n  }\n  if (isObject(value)) {\n    var other = typeof value.valueOf == 'function' ? value.valueOf() : value;\n    value = isObject(other) ? (other + '') : other;\n  }\n  if (typeof value != 'string') {\n    return value === 0 ? value : +value;\n  }\n  value = value.replace(reTrim, '');\n  var isBinary = reIsBinary.test(value);\n  return (isBinary || reIsOctal.test(value))\n    ? freeParseInt(value.slice(2), isBinary ? 2 : 8)\n    : (reIsBadHex.test(value) ? NAN : +value);\n}\n\nmodule.exports = throttle;\n","/*! pym.js - v1.3.2 - 2018-02-13 */\n/*\n* Pym.js is library that resizes an iframe based on the width of the parent and the resulting height of the child.\n* Check out the docs at http://blog.apps.npr.org/pym.js/ or the readme at README.md for usage.\n*/\n\n/** @module pym */\n(function(factory) {\n    if (typeof define === 'function' && define.amd) {\n        define(factory);\n    }\n    else if (typeof module !== 'undefined' && module.exports) {\n        module.exports = factory();\n    } else {\n        window.pym = factory.call(this);\n    }\n})(function() {\n    var MESSAGE_DELIMITER = 'xPYMx';\n\n    var lib = {};\n\n    /**\n    * Create and dispatch a custom pym event\n    *\n    * @method _raiseCustomEvent\n    * @inner\n    *\n    * @param {String} eventName\n    */\n   var _raiseCustomEvent = function(eventName) {\n     var event = document.createEvent('Event');\n     event.initEvent('pym:' + eventName, true, true);\n     document.dispatchEvent(event);\n   };\n\n    /**\n    * Generic function for parsing URL params.\n    * Via http://stackoverflow.com/questions/901115/how-can-i-get-query-string-values-in-javascript\n    *\n    * @method _getParameterByName\n    * @inner\n    *\n    * @param {String} name The name of the paramter to get from the URL.\n    */\n    var _getParameterByName = function(name) {\n        var regex = new RegExp(\"[\\\\?&]\" + name.replace(/[\\[]/, '\\\\[').replace(/[\\]]/, '\\\\]') + '=([^&#]*)');\n        var results = regex.exec(location.search);\n\n        if (results === null) {\n            return '';\n        }\n\n        return decodeURIComponent(results[1].replace(/\\+/g, \" \"));\n    };\n\n    /**\n     * Check the message to make sure it comes from an acceptable xdomain.\n     * Defaults to '*' but can be overriden in config.\n     *\n     * @method _isSafeMessage\n     * @inner\n     *\n     * @param {Event} e The message event.\n     * @param {Object} settings Configuration.\n     */\n    var _isSafeMessage = function(e, settings) {\n        if (settings.xdomain !== '*') {\n            // If origin doesn't match our xdomain, return.\n            if (!e.origin.match(new RegExp(settings.xdomain + '$'))) { return; }\n        }\n\n        // Ignore events that do not carry string data #151\n        if (typeof e.data !== 'string') { return; }\n\n        return true;\n    };\n\n    var _isSafeUrl = function(url) {\n        // Adapted from angular 2 url sanitizer\n        var SAFE_URL_PATTERN = /^(?:(?:https?|mailto|ftp):|[^&:/?#]*(?:[/?#]|$))/gi;\n        if (!url.match(SAFE_URL_PATTERN)) { return; }\n        \n        return true;\n    };\n\n    /**\n     * Construct a message to send between frames.\n     *\n     * NB: We use string-building here because JSON message passing is\n     * not supported in all browsers.\n     *\n     * @method _makeMessage\n     * @inner\n     *\n     * @param {String} id The unique id of the message recipient.\n     * @param {String} messageType The type of message to send.\n     * @param {String} message The message to send.\n     */\n    var _makeMessage = function(id, messageType, message) {\n        var bits = ['pym', id, messageType, message];\n\n        return bits.join(MESSAGE_DELIMITER);\n    };\n\n    /**\n     * Construct a regex to validate and parse messages.\n     *\n     * @method _makeMessageRegex\n     * @inner\n     *\n     * @param {String} id The unique id of the message recipient.\n     */\n    var _makeMessageRegex = function(id) {\n        var bits = ['pym', id, '(\\\\S+)', '(.*)'];\n\n        return new RegExp('^' + bits.join(MESSAGE_DELIMITER) + '$');\n    };\n\n    /**\n    * Underscore implementation of getNow\n    *\n    * @method _getNow\n    * @inner\n    *\n    */\n    var _getNow = Date.now || function() {\n        return new Date().getTime();\n    };\n\n    /**\n    * Underscore implementation of throttle\n    *\n    * @method _throttle\n    * @inner\n    *\n    * @param {function} func Throttled function\n    * @param {number} wait Throttle wait time\n    * @param {object} options Throttle settings\n    */\n\n    var _throttle = function(func, wait, options) {\n        var context, args, result;\n        var timeout = null;\n        var previous = 0;\n        if (!options) {options = {};}\n        var later = function() {\n            previous = options.leading === false ? 0 : _getNow();\n            timeout = null;\n            result = func.apply(context, args);\n            if (!timeout) {context = args = null;}\n        };\n        return function() {\n            var now = _getNow();\n            if (!previous && options.leading === false) {previous = now;}\n            var remaining = wait - (now - previous);\n            context = this;\n            args = arguments;\n            if (remaining <= 0 || remaining > wait) {\n                if (timeout) {\n                    clearTimeout(timeout);\n                    timeout = null;\n                }\n                previous = now;\n                result = func.apply(context, args);\n                if (!timeout) {context = args = null;}\n            } else if (!timeout && options.trailing !== false) {\n                timeout = setTimeout(later, remaining);\n            }\n            return result;\n        };\n    };\n\n    /**\n     * Clean autoInit Instances: those that point to contentless iframes\n     * @method _cleanAutoInitInstances\n     * @inner\n     */\n    var _cleanAutoInitInstances = function() {\n        var length = lib.autoInitInstances.length;\n\n        // Loop backwards to avoid index issues\n        for (var idx = length - 1; idx >= 0; idx--) {\n            var instance = lib.autoInitInstances[idx];\n            // If instance has been removed or is contentless then remove it\n            if (instance.el.getElementsByTagName('iframe').length &&\n                instance.el.getElementsByTagName('iframe')[0].contentWindow) {\n                continue;\n            }\n            else {\n                // Remove the reference to the removed or orphan instance\n                lib.autoInitInstances.splice(idx,1);\n            }\n        }\n    };\n\n    /**\n     * Store auto initialized Pym instances for further reference\n     * @name module:pym#autoInitInstances\n     * @type Array\n     * @default []\n     */\n    lib.autoInitInstances = [];\n\n    /**\n     * Initialize Pym for elements on page that have data-pym attributes.\n     * Expose autoinit in case we need to call it from the outside\n     * @instance\n     * @method autoInit\n     * @param {Boolean} doNotRaiseEvents flag to avoid sending custom events\n     */\n    lib.autoInit = function(doNotRaiseEvents) {\n        var elements = document.querySelectorAll('[data-pym-src]:not([data-pym-auto-initialized])');\n        var length = elements.length;\n\n        // Clean stored instances in case needed\n        _cleanAutoInitInstances();\n        for (var idx = 0; idx < length; ++idx) {\n            var element = elements[idx];\n            /*\n            * Mark automatically-initialized elements so they are not\n            * re-initialized if the user includes pym.js more than once in the\n            * same document.\n            */\n            element.setAttribute('data-pym-auto-initialized', '');\n\n            // Ensure elements have an id\n            if (element.id === '') {\n                element.id = 'pym-' + idx + \"-\" + Math.random().toString(36).substr(2,5);\n            }\n\n            var src = element.getAttribute('data-pym-src');\n\n            // List of data attributes to configure the component\n            // structure: {'attribute name': 'type'}\n            var settings = {'xdomain': 'string', 'title': 'string', 'name': 'string', 'id': 'string',\n                            'sandbox': 'string', 'allowfullscreen': 'boolean',\n                            'parenturlparam': 'string', 'parenturlvalue': 'string',\n                            'optionalparams': 'boolean', 'trackscroll': 'boolean',\n                            'scrollwait': 'number'};\n\n            var config = {};\n\n            for (var attribute in settings) {\n                // via https://developer.mozilla.org/en-US/docs/Web/API/Element/getAttribute#Notes\n               if (element.getAttribute('data-pym-'+attribute) !== null) {\n                  switch (settings[attribute]) {\n                    case 'boolean':\n                       config[attribute] = !(element.getAttribute('data-pym-'+attribute) === 'false'); // jshint ignore:line\n                       break;\n                    case 'string':\n                       config[attribute] = element.getAttribute('data-pym-'+attribute);\n                       break;\n                    case 'number':\n                        var n = Number(element.getAttribute('data-pym-'+attribute));\n                        if (!isNaN(n)) {\n                            config[attribute] = n;\n                        }\n                        break;\n                    default:\n                       console.err('unrecognized attribute type');\n                  }\n               }\n            }\n\n            // Store references to autoinitialized pym instances\n            var parent = new lib.Parent(element.id, src, config);\n            lib.autoInitInstances.push(parent);\n        }\n\n        // Fire customEvent\n        if (!doNotRaiseEvents) {\n            _raiseCustomEvent(\"pym-initialized\");\n        }\n        // Return stored autoinitalized pym instances\n        return lib.autoInitInstances;\n    };\n\n    /**\n     * The Parent half of a response iframe.\n     *\n     * @memberof module:pym\n     * @class Parent\n     * @param {String} id The id of the div into which the iframe will be rendered. sets {@link module:pym.Parent~id}\n     * @param {String} url The url of the iframe source. sets {@link module:pym.Parent~url}\n     * @param {Object} [config] Configuration for the parent instance. sets {@link module:pym.Parent~settings}\n     * @param {string} [config.xdomain='*'] - xdomain to validate messages received\n     * @param {string} [config.title] - if passed it will be assigned to the iframe title attribute\n     * @param {string} [config.name] - if passed it will be assigned to the iframe name attribute\n     * @param {string} [config.id] - if passed it will be assigned to the iframe id attribute\n     * @param {boolean} [config.allowfullscreen] - if passed and different than false it will be assigned to the iframe allowfullscreen attribute\n     * @param {string} [config.sandbox] - if passed it will be assigned to the iframe sandbox attribute (we do not validate the syntax so be careful!!)\n     * @param {string} [config.parenturlparam] - if passed it will be override the default parentUrl query string parameter name passed to the iframe src\n     * @param {string} [config.parenturlvalue] - if passed it will be override the default parentUrl query string parameter value passed to the iframe src\n     * @param {string} [config.optionalparams] - if passed and different than false it will strip the querystring params parentUrl and parentTitle passed to the iframe src\n     * @param {boolean} [config.trackscroll] - if passed it will activate scroll tracking on the parent\n     * @param {number} [config.scrollwait] - if passed it will set the throttle wait in order to fire scroll messaging. Defaults to 100 ms.\n     * @see {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/iframe iFrame}\n     */\n    lib.Parent = function(id, url, config) {\n        /**\n         * The id of the container element\n         *\n         * @memberof module:pym.Parent\n         * @member {string} id\n         * @inner\n         */\n        this.id = id;\n        /**\n         * The url that will be set as the iframe's src\n         *\n         * @memberof module:pym.Parent\n         * @member {String} url\n         * @inner\n         */\n        this.url = url;\n\n        /**\n         * The container DOM object\n         *\n         * @memberof module:pym.Parent\n         * @member {HTMLElement} el\n         * @inner\n         */\n        this.el = document.getElementById(id);\n        /**\n         * The contained child iframe\n         *\n         * @memberof module:pym.Parent\n         * @member {HTMLElement} iframe\n         * @inner\n         * @default null\n         */\n        this.iframe = null;\n        /**\n         * The parent instance settings, updated by the values passed in the config object\n         *\n         * @memberof module:pym.Parent\n         * @member {Object} settings\n         * @inner\n         */\n        this.settings = {\n            xdomain: '*',\n            optionalparams: true,\n            parenturlparam: 'parentUrl',\n            parenturlvalue: window.location.href,\n            trackscroll: false,\n            scrollwait: 100,\n        };\n        /**\n         * RegularExpression to validate the received messages\n         *\n         * @memberof module:pym.Parent\n         * @member {String} messageRegex\n         * @inner\n         */\n        this.messageRegex = _makeMessageRegex(this.id);\n        /**\n         * Stores the registered messageHandlers for each messageType\n         *\n         * @memberof module:pym.Parent\n         * @member {Object} messageHandlers\n         * @inner\n         */\n        this.messageHandlers = {};\n\n        // ensure a config object\n        config = (config || {});\n\n        /**\n         * Construct the iframe.\n         *\n         * @memberof module:pym.Parent\n         * @method _constructIframe\n         * @inner\n         */\n        this._constructIframe = function() {\n            // Calculate the width of this element.\n            var width = this.el.offsetWidth.toString();\n\n            // Create an iframe element attached to the document.\n            this.iframe = document.createElement('iframe');\n\n            // Save fragment id\n            var hash = '';\n            var hashIndex = this.url.indexOf('#');\n\n            if (hashIndex > -1) {\n                hash = this.url.substring(hashIndex, this.url.length);\n                this.url = this.url.substring(0, hashIndex);\n            }\n\n            // If the URL contains querystring bits, use them.\n            // Otherwise, just create a set of valid params.\n            if (this.url.indexOf('?') < 0) {\n                this.url += '?';\n            } else {\n                this.url += '&';\n            }\n\n            // Append the initial width as a querystring parameter\n            // and optional params if configured to do so\n            this.iframe.src = this.url + 'initialWidth=' + width +\n                                         '&childId=' + this.id;\n\n            if (this.settings.optionalparams) {\n                this.iframe.src += '&parentTitle=' + encodeURIComponent(document.title);\n                this.iframe.src += '&'+ this.settings.parenturlparam + '=' + encodeURIComponent(this.settings.parenturlvalue);\n            }\n            this.iframe.src +=hash;\n\n            // Set some attributes to this proto-iframe.\n            this.iframe.setAttribute('width', '100%');\n            this.iframe.setAttribute('scrolling', 'no');\n            this.iframe.setAttribute('marginheight', '0');\n            this.iframe.setAttribute('frameborder', '0');\n\n            if (this.settings.title) {\n                this.iframe.setAttribute('title', this.settings.title);\n            }\n\n            if (this.settings.allowfullscreen !== undefined && this.settings.allowfullscreen !== false) {\n                this.iframe.setAttribute('allowfullscreen','');\n            }\n\n            if (this.settings.sandbox !== undefined && typeof this.settings.sandbox === 'string') {\n                this.iframe.setAttribute('sandbox', this.settings.sandbox);\n            }\n\n            if (this.settings.id) {\n                if (!document.getElementById(this.settings.id)) {\n                    this.iframe.setAttribute('id', this.settings.id);\n                }\n            }\n\n            if (this.settings.name) {\n                this.iframe.setAttribute('name', this.settings.name);\n            }\n\n            // Replace the child content if needed\n            // (some CMSs might strip out empty elements)\n            while(this.el.firstChild) { this.el.removeChild(this.el.firstChild); }\n            // Append the iframe to our element.\n            this.el.appendChild(this.iframe);\n\n            // Add an event listener that will handle redrawing the child on resize.\n            window.addEventListener('resize', this._onResize);\n\n            // Add an event listener that will send the child the viewport.\n            if (this.settings.trackscroll) {\n                window.addEventListener('scroll', this._throttleOnScroll);\n            }\n        };\n\n        /**\n         * Send width on resize.\n         *\n         * @memberof module:pym.Parent\n         * @method _onResize\n         * @inner\n         */\n        this._onResize = function() {\n            this.sendWidth();\n            if (this.settings.trackscroll) {\n                this.sendViewportAndIFramePosition();\n            }\n        }.bind(this);\n\n        /**\n         * Send viewport and iframe info on scroll.\n         *\n         * @memberof module:pym.Parent\n         * @method _onScroll\n         * @inner\n         */\n        this._onScroll = function() {\n            this.sendViewportAndIFramePosition();\n        }.bind(this);\n\n        /**\n         * Fire all event handlers for a given message type.\n         *\n         * @memberof module:pym.Parent\n         * @method _fire\n         * @inner\n         *\n         * @param {String} messageType The type of message.\n         * @param {String} message The message data.\n         */\n        this._fire = function(messageType, message) {\n            if (messageType in this.messageHandlers) {\n                for (var i = 0; i < this.messageHandlers[messageType].length; i++) {\n                   this.messageHandlers[messageType][i].call(this, message);\n                }\n            }\n        };\n\n        /**\n         * Remove this parent from the page and unbind it's event handlers.\n         *\n         * @memberof module:pym.Parent\n         * @method remove\n         * @instance\n         */\n        this.remove = function() {\n            window.removeEventListener('message', this._processMessage);\n            window.removeEventListener('resize', this._onResize);\n\n            this.el.removeChild(this.iframe);\n            // _cleanAutoInitInstances in case this parent was autoInitialized\n            _cleanAutoInitInstances();\n        };\n\n        /**\n         * Process a new message from the child.\n         *\n         * @memberof module:pym.Parent\n         * @method _processMessage\n         * @inner\n         *\n         * @param {Event} e A message event.\n         */\n        this._processMessage = function(e) {\n            // First, punt if this isn't from an acceptable xdomain.\n            if (!_isSafeMessage(e, this.settings)) {\n                return;\n            }\n\n            // Discard object messages, we only care about strings\n            if (typeof e.data !== 'string') {\n                return;\n            }\n\n            // Grab the message from the child and parse it.\n            var match = e.data.match(this.messageRegex);\n\n            // If there's no match or too many matches in the message, punt.\n            if (!match || match.length !== 3) {\n                return false;\n            }\n\n            var messageType = match[1];\n            var message = match[2];\n\n            this._fire(messageType, message);\n        }.bind(this);\n\n        /**\n         * Resize iframe in response to new height message from child.\n         *\n         * @memberof module:pym.Parent\n         * @method _onHeightMessage\n         * @inner\n         *\n         * @param {String} message The new height.\n         */\n        this._onHeightMessage = function(message) {\n            /*\n             * Handle parent height message from child.\n             */\n            var height = parseInt(message);\n\n            this.iframe.setAttribute('height', height + 'px');\n        };\n\n        /**\n         * Navigate parent to a new url.\n         *\n         * @memberof module:pym.Parent\n         * @method _onNavigateToMessage\n         * @inner\n         *\n         * @param {String} message The url to navigate to.\n         */\n        this._onNavigateToMessage = function(message) {\n            /*\n             * Handle parent scroll message from child.\n             */\n             if (!_isSafeUrl(message)) {return;}\n            document.location.href = message;\n        };\n\n        /**\n         * Scroll parent to a given child position.\n         *\n         * @memberof module:pym.Parent\n         * @method _onScrollToChildPosMessage\n         * @inner\n         *\n         * @param {String} message The offset inside the child page.\n         */\n        this._onScrollToChildPosMessage = function(message) {\n            // Get the child container position using getBoundingClientRect + pageYOffset\n            // via https://developer.mozilla.org/en-US/docs/Web/API/Element/getBoundingClientRect\n            var iframePos = document.getElementById(this.id).getBoundingClientRect().top + window.pageYOffset;\n\n            var totalOffset = iframePos + parseInt(message);\n            window.scrollTo(0, totalOffset);\n        };\n\n        /**\n         * Bind a callback to a given messageType from the child.\n         *\n         * Reserved message names are: \"height\", \"scrollTo\" and \"navigateTo\".\n         *\n         * @memberof module:pym.Parent\n         * @method onMessage\n         * @instance\n         *\n         * @param {String} messageType The type of message being listened for.\n         * @param {module:pym.Parent~onMessageCallback} callback The callback to invoke when a message of the given type is received.\n         */\n        this.onMessage = function(messageType, callback) {\n            if (!(messageType in this.messageHandlers)) {\n                this.messageHandlers[messageType] = [];\n            }\n\n            this.messageHandlers[messageType].push(callback);\n        };\n\n        /**\n         * @callback module:pym.Parent~onMessageCallback\n         * @param {String} message The message data.\n         */\n\n        /**\n         * Send a message to the the child.\n         *\n         * @memberof module:pym.Parent\n         * @method sendMessage\n         * @instance\n         *\n         * @param {String} messageType The type of message to send.\n         * @param {String} message The message data to send.\n         */\n        this.sendMessage = function(messageType, message) {\n            // When used alongside with pjax some references are lost\n            if (this.el.getElementsByTagName('iframe').length) {\n                if (this.el.getElementsByTagName('iframe')[0].contentWindow) {\n                    this.el.getElementsByTagName('iframe')[0].contentWindow\n                        .postMessage(_makeMessage(this.id, messageType, message), '*');\n                }\n                else {\n                    // Contentless child detected remove listeners and iframe\n                    this.remove();\n                }\n            }\n        };\n\n        /**\n         * Transmit the current iframe width to the child.\n         *\n         * You shouldn't need to call this directly.\n         *\n         * @memberof module:pym.Parent\n         * @method sendWidth\n         * @instance\n         */\n        this.sendWidth = function() {\n            var width = this.el.offsetWidth.toString();\n            this.sendMessage('width', width);\n        };\n\n        /**\n         * Transmit the current viewport and iframe position to the child.\n         * Sends viewport width, viewport height\n         * and iframe bounding rect top-left-bottom-right\n         * all separated by spaces\n         *\n         * You shouldn't need to call this directly.\n         *\n         * @memberof module:pym.Parent\n         * @method sendViewportAndIFramePosition\n         * @instance\n         */\n        this.sendViewportAndIFramePosition = function() {\n            var iframeRect = this.iframe.getBoundingClientRect();\n            var vWidth   = window.innerWidth || document.documentElement.clientWidth;\n            var vHeight  = window.innerHeight || document.documentElement.clientHeight;\n            var payload = vWidth + ' ' + vHeight;\n            payload += ' ' + iframeRect.top + ' ' + iframeRect.left;\n            payload += ' ' + iframeRect.bottom + ' ' + iframeRect.right;\n            this.sendMessage('viewport-iframe-position', payload);\n        };\n\n        // Add any overrides to settings coming from config.\n        for (var key in config) {\n            this.settings[key] = config[key];\n        }\n\n        /**\n         * Throttled scroll function.\n         *\n         * @memberof module:pym.Parent\n         * @method _throttleOnScroll\n         * @inner\n         */\n        this._throttleOnScroll = _throttle(this._onScroll.bind(this), this.settings.scrollwait);\n\n        // Bind required message handlers\n        this.onMessage('height', this._onHeightMessage);\n        this.onMessage('navigateTo', this._onNavigateToMessage);\n        this.onMessage('scrollToChildPos', this._onScrollToChildPosMessage);\n        this.onMessage('parentPositionInfo', this.sendViewportAndIFramePosition);\n\n        // Add a listener for processing messages from the child.\n        window.addEventListener('message', this._processMessage, false);\n\n        // Construct the iframe in the container element.\n        this._constructIframe();\n\n        return this;\n    };\n\n    /**\n     * The Child half of a responsive iframe.\n     *\n     * @memberof module:pym\n     * @class Child\n     * @param {Object} [config] Configuration for the child instance. sets {@link module:pym.Child~settings}\n     * @param {function} [config.renderCallback=null] Callback invoked after receiving a resize event from the parent, sets {@link module:pym.Child#settings.renderCallback}\n     * @param {string} [config.xdomain='*'] - xdomain to validate messages received\n     * @param {number} [config.polling=0] - polling frequency in milliseconds to send height to parent\n     * @param {number} [config.id] - parent container id used when navigating the child iframe to a new page but we want to keep it responsive.\n     * @param {string} [config.parenturlparam] - if passed it will be override the default parentUrl query string parameter name expected on the iframe src\n     */\n    lib.Child = function(config) {\n        /**\n         * The initial width of the parent page\n         *\n         * @memberof module:pym.Child\n         * @member {string} parentWidth\n         * @inner\n         */\n        this.parentWidth = null;\n        /**\n         * The id of the parent container\n         *\n         * @memberof module:pym.Child\n         * @member {String} id\n         * @inner\n         */\n        this.id = null;\n        /**\n         * The title of the parent page from document.title.\n         *\n         * @memberof module:pym.Child\n         * @member {String} parentTitle\n         * @inner\n         */\n        this.parentTitle = null;\n        /**\n         * The URL of the parent page from window.location.href.\n         *\n         * @memberof module:pym.Child\n         * @member {String} parentUrl\n         * @inner\n         */\n        this.parentUrl = null;\n        /**\n         * The settings for the child instance. Can be overriden by passing a config object to the child constructor\n         * i.e.: var pymChild = new pym.Child({renderCallback: render, xdomain: \"\\\\*\\.npr\\.org\"})\n         *\n         * @memberof module:pym.Child.settings\n         * @member {Object} settings - default settings for the child instance\n         * @inner\n         */\n        this.settings = {\n            renderCallback: null,\n            xdomain: '*',\n            polling: 0,\n            parenturlparam: 'parentUrl'\n        };\n\n        /**\n         * The timerId in order to be able to stop when polling is enabled\n         *\n         * @memberof module:pym.Child\n         * @member {String} timerId\n         * @inner\n         */\n        this.timerId = null;\n        /**\n         * RegularExpression to validate the received messages\n         *\n         * @memberof module:pym.Child\n         * @member {String} messageRegex\n         * @inner\n         */\n        this.messageRegex = null;\n        /**\n         * Stores the registered messageHandlers for each messageType\n         *\n         * @memberof module:pym.Child\n         * @member {Object} messageHandlers\n         * @inner\n         */\n        this.messageHandlers = {};\n\n        // Ensure a config object\n        config = (config || {});\n\n        /**\n         * Bind a callback to a given messageType from the child.\n         *\n         * Reserved message names are: \"width\".\n         *\n         * @memberof module:pym.Child\n         * @method onMessage\n         * @instance\n         *\n         * @param {String} messageType The type of message being listened for.\n         * @param {module:pym.Child~onMessageCallback} callback The callback to invoke when a message of the given type is received.\n         */\n        this.onMessage = function(messageType, callback) {\n\n            if (!(messageType in this.messageHandlers)) {\n                this.messageHandlers[messageType] = [];\n            }\n\n            this.messageHandlers[messageType].push(callback);\n        };\n\n        /**\n         * @callback module:pym.Child~onMessageCallback\n         * @param {String} message The message data.\n         */\n\n\n        /**\n         * Fire all event handlers for a given message type.\n         *\n         * @memberof module:pym.Child\n         * @method _fire\n         * @inner\n         *\n         * @param {String} messageType The type of message.\n         * @param {String} message The message data.\n         */\n        this._fire = function(messageType, message) {\n            /*\n             * Fire all event handlers for a given message type.\n             */\n            if (messageType in this.messageHandlers) {\n                for (var i = 0; i < this.messageHandlers[messageType].length; i++) {\n                   this.messageHandlers[messageType][i].call(this, message);\n                }\n            }\n        };\n\n        /**\n         * Process a new message from the parent.\n         *\n         * @memberof module:pym.Child\n         * @method _processMessage\n         * @inner\n         *\n         * @param {Event} e A message event.\n         */\n        this._processMessage = function(e) {\n            /*\n            * Process a new message from parent frame.\n            */\n            // First, punt if this isn't from an acceptable xdomain.\n            if (!_isSafeMessage(e, this.settings)) {\n                return;\n            }\n\n            // Discard object messages, we only care about strings\n            if (typeof e.data !== 'string') {\n                return;\n            }\n\n            // Get the message from the parent.\n            var match = e.data.match(this.messageRegex);\n\n            // If there's no match or it's a bad format, punt.\n            if (!match || match.length !== 3) { return; }\n\n            var messageType = match[1];\n            var message = match[2];\n\n            this._fire(messageType, message);\n        }.bind(this);\n\n        /**\n         * Resize iframe in response to new width message from parent.\n         *\n         * @memberof module:pym.Child\n         * @method _onWidthMessage\n         * @inner\n         *\n         * @param {String} message The new width.\n         */\n        this._onWidthMessage = function(message) {\n            /*\n             * Handle width message from the child.\n             */\n            var width = parseInt(message);\n\n            // Change the width if it's different.\n            if (width !== this.parentWidth) {\n                this.parentWidth = width;\n\n                // Call the callback function if it exists.\n                if (this.settings.renderCallback) {\n                    this.settings.renderCallback(width);\n                }\n\n                // Send the height back to the parent.\n                this.sendHeight();\n            }\n        };\n\n        /**\n         * Send a message to the the Parent.\n         *\n         * @memberof module:pym.Child\n         * @method sendMessage\n         * @instance\n         *\n         * @param {String} messageType The type of message to send.\n         * @param {String} message The message data to send.\n         */\n        this.sendMessage = function(messageType, message) {\n            /*\n             * Send a message to the parent.\n             */\n            window.parent.postMessage(_makeMessage(this.id, messageType, message), '*');\n        };\n\n        /**\n         * Transmit the current iframe height to the parent.\n         *\n         * Call this directly in cases where you manually alter the height of the iframe contents.\n         *\n         * @memberof module:pym.Child\n         * @method sendHeight\n         * @instance\n         */\n        this.sendHeight = function() {\n            // Get the child's height.\n            var height = document.getElementsByTagName('body')[0].offsetHeight.toString();\n\n            // Send the height to the parent.\n            this.sendMessage('height', height);\n\n            return height;\n        }.bind(this);\n\n        /**\n         * Ask parent to send the current viewport and iframe position information\n         *\n         * @memberof module:pym.Child\n         * @method sendHeight\n         * @instance\n         */\n        this.getParentPositionInfo = function() {\n            // Send the height to the parent.\n            this.sendMessage('parentPositionInfo');\n        };\n\n        /**\n         * Scroll parent to a given element id.\n         *\n         * @memberof module:pym.Child\n         * @method scrollParentTo\n         * @instance\n         *\n         * @param {String} hash The id of the element to scroll to.\n         */\n        this.scrollParentTo = function(hash) {\n            this.sendMessage('navigateTo', '#' + hash);\n        };\n\n        /**\n         * Navigate parent to a given url.\n         *\n         * @memberof module:pym.Child\n         * @method navigateParentTo\n         * @instance\n         *\n         * @param {String} url The url to navigate to.\n         */\n        this.navigateParentTo = function(url) {\n            this.sendMessage('navigateTo', url);\n        };\n\n        /**\n         * Scroll parent to a given child element id.\n         *\n         * @memberof module:pym.Child\n         * @method scrollParentToChildEl\n         * @instance\n         *\n         * @param {String} id The id of the child element to scroll to.\n         */\n        this.scrollParentToChildEl = function(id) {\n            // Get the child element position using getBoundingClientRect + pageYOffset\n            // via https://developer.mozilla.org/en-US/docs/Web/API/Element/getBoundingClientRect\n            var topPos = document.getElementById(id).getBoundingClientRect().top + window.pageYOffset;\n            this.scrollParentToChildPos(topPos);\n        };\n\n        /**\n         * Scroll parent to a particular child offset.\n         *\n         * @memberof module:pym.Child\n         * @method scrollParentToChildPos\n         * @instance\n         *\n         * @param {Number} pos The offset of the child element to scroll to.\n         */\n        this.scrollParentToChildPos = function(pos) {\n            this.sendMessage('scrollToChildPos', pos.toString());\n        };\n\n        /**\n         * Mark Whether the child is embedded or not\n         * executes a callback in case it was passed to the config\n         *\n         * @memberof module:pym.Child\n         * @method _markWhetherEmbedded\n         * @inner\n         *\n         * @param {module:pym.Child~onMarkedEmbeddedStatus} The callback to execute after determining whether embedded or not.\n         */\n        var _markWhetherEmbedded = function(onMarkedEmbeddedStatus) {\n          var htmlElement = document.getElementsByTagName('html')[0],\n              newClassForHtml,\n              originalHtmlClasses = htmlElement.className;\n          try {\n            if(window.self !== window.top) {\n              newClassForHtml = \"embedded\";\n            }else{\n              newClassForHtml = \"not-embedded\";\n            }\n          }catch(e) {\n            newClassForHtml = \"embedded\";\n          }\n          if(originalHtmlClasses.indexOf(newClassForHtml) < 0) {\n            htmlElement.className = originalHtmlClasses ? originalHtmlClasses + ' ' + newClassForHtml : newClassForHtml;\n            if(onMarkedEmbeddedStatus){\n              onMarkedEmbeddedStatus(newClassForHtml);\n            }\n            _raiseCustomEvent(\"marked-embedded\");\n          }\n        };\n\n        /**\n         * @callback module:pym.Child~onMarkedEmbeddedStatus\n         * @param {String} classname \"embedded\" or \"not-embedded\".\n         */\n\n        /**\n         * Unbind child event handlers and timers.\n         *\n         * @memberof module:pym.Child\n         * @method remove\n         * @instance\n         */\n        this.remove = function() {\n            window.removeEventListener('message', this._processMessage);\n            if (this.timerId) {\n                clearInterval(this.timerId);\n            }\n        };\n\n        // Initialize settings with overrides.\n        for (var key in config) {\n            this.settings[key] = config[key];\n        }\n\n        // Identify what ID the parent knows this child as.\n        this.id = _getParameterByName('childId') || config.id;\n        this.messageRegex = new RegExp('^pym' + MESSAGE_DELIMITER + this.id + MESSAGE_DELIMITER + '(\\\\S+)' + MESSAGE_DELIMITER + '(.*)$');\n\n        // Get the initial width from a URL parameter.\n        var width = parseInt(_getParameterByName('initialWidth'));\n\n        // Get the url of the parent frame\n        this.parentUrl = _getParameterByName(this.settings.parenturlparam);\n\n        // Get the title of the parent frame\n        this.parentTitle = _getParameterByName('parentTitle');\n\n        // Bind the required message handlers\n        this.onMessage('width', this._onWidthMessage);\n\n        // Set up a listener to handle any incoming messages.\n        window.addEventListener('message', this._processMessage, false);\n\n        // If there's a callback function, call it.\n        if (this.settings.renderCallback) {\n            this.settings.renderCallback(width);\n        }\n\n        // Send the initial height to the parent.\n        this.sendHeight();\n\n        // If we're configured to poll, create a setInterval to handle that.\n        if (this.settings.polling) {\n            this.timerId = window.setInterval(this.sendHeight, this.settings.polling);\n        }\n\n        _markWhetherEmbedded(config.onMarkedEmbeddedStatus);\n\n        return this;\n    };\n\n    // Initialize elements with pym data attributes\n    // if we are not in server configuration\n    if(typeof document !== \"undefined\") {\n        lib.autoInit(true);\n    }\n\n    return lib;\n});\n\n","!function(t,e){\"object\"==typeof exports&&\"object\"==typeof module?module.exports=e():\"function\"==typeof define&&define.amd?define(\"scrollMonitor\",[],e):\"object\"==typeof exports?exports.scrollMonitor=e():t.scrollMonitor=e()}(this,function(){return function(t){function e(o){if(i[o])return i[o].exports;var s=i[o]={exports:{},id:o,loaded:!1};return t[o].call(s.exports,s,s.exports,e),s.loaded=!0,s.exports}var i={};return e.m=t,e.c=i,e.p=\"\",e(0)}([function(t,e,i){\"use strict\";var o=i(1),s=o.isInBrowser,n=i(2),r=new n(s?document.body:null);r.setStateFromDOM(null),r.listenToDOM(),s&&(window.scrollMonitor=r),t.exports=r},function(t,e){\"use strict\";e.VISIBILITYCHANGE=\"visibilityChange\",e.ENTERVIEWPORT=\"enterViewport\",e.FULLYENTERVIEWPORT=\"fullyEnterViewport\",e.EXITVIEWPORT=\"exitViewport\",e.PARTIALLYEXITVIEWPORT=\"partiallyExitViewport\",e.LOCATIONCHANGE=\"locationChange\",e.STATECHANGE=\"stateChange\",e.eventTypes=[e.VISIBILITYCHANGE,e.ENTERVIEWPORT,e.FULLYENTERVIEWPORT,e.EXITVIEWPORT,e.PARTIALLYEXITVIEWPORT,e.LOCATIONCHANGE,e.STATECHANGE],e.isOnServer=\"undefined\"==typeof window,e.isInBrowser=!e.isOnServer,e.defaultOffsets={top:0,bottom:0}},function(t,e,i){\"use strict\";function o(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}function s(t){return c?0:t===document.body?window.innerHeight||document.documentElement.clientHeight:t.clientHeight}function n(t){return c?0:t===document.body?Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.documentElement.clientHeight):t.scrollHeight}function r(t){return c?0:t===document.body?window.pageYOffset||document.documentElement&&document.documentElement.scrollTop||document.body.scrollTop:t.scrollTop}var h=i(1),c=h.isOnServer,a=h.isInBrowser,l=h.eventTypes,p=i(3),u=!1;if(a)try{var w=Object.defineProperty({},\"passive\",{get:function(){u=!0}});window.addEventListener(\"test\",null,w)}catch(t){}var d=!!u&&{capture:!1,passive:!0},f=function(){function t(e,i){function h(){if(a.viewportTop=r(e),a.viewportBottom=a.viewportTop+a.viewportHeight,a.documentHeight=n(e),a.documentHeight!==p){for(u=a.watchers.length;u--;)a.watchers[u].recalculateLocation();p=a.documentHeight}}function c(){for(w=a.watchers.length;w--;)a.watchers[w].update();for(w=a.watchers.length;w--;)a.watchers[w].triggerCallbacks()}o(this,t);var a=this;this.item=e,this.watchers=[],this.viewportTop=null,this.viewportBottom=null,this.documentHeight=n(e),this.viewportHeight=s(e),this.DOMListener=function(){t.prototype.DOMListener.apply(a,arguments)},this.eventTypes=l,i&&(this.containerWatcher=i.create(e));var p,u,w;this.update=function(){h(),c()},this.recalculateLocations=function(){this.documentHeight=0,this.update()}}return t.prototype.listenToDOM=function(){a&&(window.addEventListener?(this.item===document.body?window.addEventListener(\"scroll\",this.DOMListener,d):this.item.addEventListener(\"scroll\",this.DOMListener,d),window.addEventListener(\"resize\",this.DOMListener)):(this.item===document.body?window.attachEvent(\"onscroll\",this.DOMListener):this.item.attachEvent(\"onscroll\",this.DOMListener),window.attachEvent(\"onresize\",this.DOMListener)),this.destroy=function(){window.addEventListener?(this.item===document.body?(window.removeEventListener(\"scroll\",this.DOMListener,d),this.containerWatcher.destroy()):this.item.removeEventListener(\"scroll\",this.DOMListener,d),window.removeEventListener(\"resize\",this.DOMListener)):(this.item===document.body?(window.detachEvent(\"onscroll\",this.DOMListener),this.containerWatcher.destroy()):this.item.detachEvent(\"onscroll\",this.DOMListener),window.detachEvent(\"onresize\",this.DOMListener))})},t.prototype.destroy=function(){},t.prototype.DOMListener=function(t){this.setStateFromDOM(t)},t.prototype.setStateFromDOM=function(t){var e=r(this.item),i=s(this.item),o=n(this.item);this.setState(e,i,o,t)},t.prototype.setState=function(t,e,i,o){var s=e!==this.viewportHeight||i!==this.contentHeight;if(this.latestEvent=o,this.viewportTop=t,this.viewportHeight=e,this.viewportBottom=t+e,this.contentHeight=i,s)for(var n=this.watchers.length;n--;)this.watchers[n].recalculateLocation();this.updateAndTriggerWatchers(o)},t.prototype.updateAndTriggerWatchers=function(t){for(var e=this.watchers.length;e--;)this.watchers[e].update();for(e=this.watchers.length;e--;)this.watchers[e].triggerCallbacks(t)},t.prototype.createCustomContainer=function(){return new t},t.prototype.createContainer=function(e){\"string\"==typeof e?e=document.querySelector(e):e&&e.length>0&&(e=e[0]);var i=new t(e,this);return i.setStateFromDOM(),i.listenToDOM(),i},t.prototype.create=function(t,e){\"string\"==typeof t?t=document.querySelector(t):t&&t.length>0&&(t=t[0]);var i=new p(this,t,e);return this.watchers.push(i),i},t.prototype.beget=function(t,e){return this.create(t,e)},t}();t.exports=f},function(t,e,i){\"use strict\";function o(t,e,i){function o(t,e){if(0!==t.length)for(E=t.length;E--;)y=t[E],y.callback.call(s,e,s),y.isOne&&t.splice(E,1)}var s=this;this.watchItem=e,this.container=t,i?i===+i?this.offsets={top:i,bottom:i}:this.offsets={top:i.top||w.top,bottom:i.bottom||w.bottom}:this.offsets=w,this.callbacks={};for(var d=0,f=u.length;d<f;d++)s.callbacks[u[d]]=[];this.locked=!1;var m,v,b,I,E,y;this.triggerCallbacks=function(t){switch(this.isInViewport&&!m&&o(this.callbacks[r],t),this.isFullyInViewport&&!v&&o(this.callbacks[h],t),this.isAboveViewport!==b&&this.isBelowViewport!==I&&(o(this.callbacks[n],t),v||this.isFullyInViewport||(o(this.callbacks[h],t),o(this.callbacks[a],t)),m||this.isInViewport||(o(this.callbacks[r],t),o(this.callbacks[c],t))),!this.isFullyInViewport&&v&&o(this.callbacks[a],t),!this.isInViewport&&m&&o(this.callbacks[c],t),this.isInViewport!==m&&o(this.callbacks[n],t),!0){case m!==this.isInViewport:case v!==this.isFullyInViewport:case b!==this.isAboveViewport:case I!==this.isBelowViewport:o(this.callbacks[p],t)}m=this.isInViewport,v=this.isFullyInViewport,b=this.isAboveViewport,I=this.isBelowViewport},this.recalculateLocation=function(){if(!this.locked){var t=this.top,e=this.bottom;if(this.watchItem.nodeName){var i=this.watchItem.style.display;\"none\"===i&&(this.watchItem.style.display=\"\");for(var s=0,n=this.container;n.containerWatcher;)s+=n.containerWatcher.top-n.containerWatcher.container.viewportTop,n=n.containerWatcher.container;var r=this.watchItem.getBoundingClientRect();this.top=r.top+this.container.viewportTop-s,this.bottom=r.bottom+this.container.viewportTop-s,\"none\"===i&&(this.watchItem.style.display=i)}else this.watchItem===+this.watchItem?this.watchItem>0?this.top=this.bottom=this.watchItem:this.top=this.bottom=this.container.documentHeight-this.watchItem:(this.top=this.watchItem.top,this.bottom=this.watchItem.bottom);this.top-=this.offsets.top,this.bottom+=this.offsets.bottom,this.height=this.bottom-this.top,void 0===t&&void 0===e||this.top===t&&this.bottom===e||o(this.callbacks[l],null)}},this.recalculateLocation(),this.update(),m=this.isInViewport,v=this.isFullyInViewport,b=this.isAboveViewport,I=this.isBelowViewport}var s=i(1),n=s.VISIBILITYCHANGE,r=s.ENTERVIEWPORT,h=s.FULLYENTERVIEWPORT,c=s.EXITVIEWPORT,a=s.PARTIALLYEXITVIEWPORT,l=s.LOCATIONCHANGE,p=s.STATECHANGE,u=s.eventTypes,w=s.defaultOffsets;o.prototype={on:function(t,e,i){switch(!0){case t===n&&!this.isInViewport&&this.isAboveViewport:case t===r&&this.isInViewport:case t===h&&this.isFullyInViewport:case t===c&&this.isAboveViewport&&!this.isInViewport:case t===a&&this.isInViewport&&this.isAboveViewport:if(e.call(this,this.container.latestEvent,this),i)return}if(!this.callbacks[t])throw new Error(\"Tried to add a scroll monitor listener of type \"+t+\". Your options are: \"+u.join(\", \"));this.callbacks[t].push({callback:e,isOne:i||!1})},off:function(t,e){if(!this.callbacks[t])throw new Error(\"Tried to remove a scroll monitor listener of type \"+t+\". Your options are: \"+u.join(\", \"));for(var i,o=0;i=this.callbacks[t][o];o++)if(i.callback===e){this.callbacks[t].splice(o,1);break}},one:function(t,e){this.on(t,e,!0)},recalculateSize:function(){this.height=this.watchItem.offsetHeight+this.offsets.top+this.offsets.bottom,this.bottom=this.top+this.height},update:function(){this.isAboveViewport=this.top<this.container.viewportTop,this.isBelowViewport=this.bottom>this.container.viewportBottom,this.isInViewport=this.top<this.container.viewportBottom&&this.bottom>this.container.viewportTop,this.isFullyInViewport=this.top>=this.container.viewportTop&&this.bottom<=this.container.viewportBottom||this.isAboveViewport&&this.isBelowViewport},destroy:function(){var t=this.container.watchers.indexOf(this),e=this;this.container.watchers.splice(t,1);for(var i=0,o=u.length;i<o;i++)e.callbacks[u[i]].length=0},lock:function(){this.locked=!0},unlock:function(){this.locked=!1}};for(var d=function(t){return function(e,i){this.on.call(this,t,e,i)}},f=0,m=u.length;f<m;f++){var v=u[f];o.prototype[v]=d(v)}t.exports=o}])});\n//# sourceMappingURL=scrollMonitor.js.map"]}